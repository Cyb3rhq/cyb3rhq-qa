- block:

  - name: Ensure Dashboard certificates directory permissions.
    file:
      path: "/etc/cyb3rhq-dashboard/certs/"
      state: directory
      owner: cyb3rhq-dashboard
      group: cyb3rhq-dashboard
      mode: 500

  - name: Copy the certificates from local to the Cyb3rhq dashboard instance
    copy:
      src: "{{ local_certs_path }}/cyb3rhq-certificates/{{ item }}"
      dest: /etc/cyb3rhq-dashboard/certs/
      owner: cyb3rhq-dashboard
      group: cyb3rhq-dashboard
      mode: 0400
    with_items:
      - "root-ca.pem"
      - "{{ dashboard_node_name }}-key.pem"
      - "{{ dashboard_node_name }}.pem"
  tags:
  - security
